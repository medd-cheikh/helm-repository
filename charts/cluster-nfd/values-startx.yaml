# Default values for configuration of a STARTX cluster
# see values.yaml for explanation on each params
context: &context
  scope: startx
  cluster: default
  environment: infra
  component: nfd
  app: startx-nfd
nfd:
  enabled: false
  list:
    - name: nfd-instance
      spec: |-
        customConfig:
          configData: |
            #    - name: "more.kernel.features"
            #      matchOn:
            #      - loadedKMod: ["example_kmod3"]
            #    - name: "more.features.by.nodename"
            #      value: customValue
            #      matchOn:
            #      - nodename: ["special-.*-node-.*"]
        operand:
          image: >-
            registry.redhat.io/openshift4/ose-node-feature-discovery
          servicePort: 12000
        workerConfig:
          configData: |
            core:
            #  labelWhiteList:
            #  noPublish: false
              sleepInterval: 60s
            #  sources: [all]
            #  klog:
            #    addDirHeader: false
            #    alsologtostderr: false
            #    logBacktraceAt:
            #    logtostderr: true
            #    skipHeaders: false
            #    stderrthreshold: 2
            #    v: 0
            #    vmodule:
            ##   NOTE: the following options are not dynamically run-time 
            ##          configurable and require a nfd-worker restart to take effect
            ##          after being changed
            #    logDir:
            #    logFile:
            #    logFileMaxSize: 1800
            #    skipLogHeaders: false
            sources:
            #  cpu:
            #    cpuid:
            ##     NOTE: whitelist has priority over blacklist
            #      attributeBlacklist:
            #        - "BMI1"
            #        - "BMI2"
            #        - "CLMUL"
            #        - "CMOV"
            #        - "CX16"
            #        - "ERMS"
            #        - "F16C"
            #        - "HTT"
            #        - "LZCNT"
            #        - "MMX"
            #        - "MMXEXT"
            #        - "NX"
            #        - "POPCNT"
            #        - "RDRAND"
            #        - "RDSEED"
            #        - "RDTSCP"
            #        - "SGX"
            #        - "SSE"
            #        - "SSE2"
            #        - "SSE3"
            #        - "SSE4.1"
            #        - "SSE4.2"
            #        - "SSSE3"
            #      attributeWhitelist:
            #  kernel:
            #    kconfigFile: "/path/to/kconfig"
            #    configOpts:
            #      - "NO_HZ"
            #      - "X86"
            #      - "DMI"
              pci:
                deviceClassWhitelist:
                  - "0200"
                  - "03"
                  - "12"
                deviceLabelFields:
            #      - "class"
                  - "vendor"
            #      - "device"
            #      - "subsystem_vendor"
            #      - "subsystem_device"
            #  usb:
            #    deviceClassWhitelist:
            #      - "0e"
            #      - "ef"
            #      - "fe"
            #      - "ff"
            #    deviceLabelFields:
            #      - "class"
            #      - "vendor"
            #      - "device"
            #  custom:
            #    - name: "my.kernel.feature"
            #      matchOn:
            #        - loadedKMod: ["example_kmod1", "example_kmod2"]
            #    - name: "my.pci.feature"
            #      matchOn:
            #        - pciId:
            #            class: ["0200"]
            #            vendor: ["15b3"]
            #            device: ["1014", "1017"]
            #        - pciId :
            #            vendor: ["8086"]
            #            device: ["1000", "1100"]
            #    - name: "my.usb.feature"
            #      matchOn:
            #        - usbId:
            #          class: ["ff"]
            #          vendor: ["03e7"]
            #          device: ["2485"]
            #        - usbId:
            #          class: ["fe"]
            #          vendor: ["1a6e"]
            #          device: ["089a"]
            #    - name: "my.combined.feature"
            #      matchOn:
            #        - pciId:
            #            vendor: ["15b3"]
            #            device: ["1014", "1017"]
            #          loadedKMod : ["vendor_kmod1", "vendor_kmod2"]
nfr:
  enabled: false
  list: []
project: 
  enabled: false
  context: 
    <<: *context
  project: 
    enabled: false
    hooked: false
    type: project
    name: "openshift-nfd"
    display_name: Operator NFD
    description: NFD configured by STARTX
operator:
  enabled: false
  context: 
    <<: *context
  subscription:
    enabled: true
    hooked: false
    name: "nfd"
    namespace: "openshift-nfd"
    version: "4.15.0-202410230304"
    operator: 
      channel: "stable"
      name: nfd
      installPlanApproval: Automatic
      # csv: nfd
      source: 
        name: redhat-operators
        namespace: openshift-marketplace
      config: 
        infra: true
        # resources: 
        #   limits:
        #     cpu: 400m
        #   requests:
        #     cpu: 400m
  operatorGroup:
    enabled: false
    hooked: false
    name: "nfd"
    namespace: "openshift-nfd"
    providedAPIs: "NodeFeatureDiscovery.v1.nfd.openshift.io,NodeFeatureRule.v1alpha1.nfd.openshift.io,NodeResourceTopology.v1alpha1.topology.node.k8s.io"
