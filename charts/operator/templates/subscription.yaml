{{- if .Values.tekton }}{{- if .Values.tekton.enabled }}
---
kind: Subscription
apiVersion: operators.coreos.com/v1alpha1
metadata:
  name: openshift-pipelines-operator-rh
  namespace: {{ .Values.tekton.namespace | default "openshift-operators" | quote }}
  labels:
    {{- include "operator.labels" . | nindent 4 }}
    app.kubernetes.io/name: "codeready-workspaces-subscription"
  annotations:
    {{- include "operator.annotations" . | nindent 4 }}
spec:
{{- if .Values.tekton.operator }}{{- if .Values.tekton.operator.channel }}
  channel: {{ .Values.tekton.operator.channel | quote }}
{{- else }}
  channel: ocp-4.5
{{- end }}
{{- else }}
  channel: ocp-4.5
{{- end }}
  installPlanApproval: Automatic
{{- if .Values.tekton.operator }}{{- if .Values.tekton.operator.name }}
  name: {{ .Values.tekton.operator.name | quote }}
{{- else }}
  name: openshift-pipelines-operator-rh
{{- end }}
{{- else }}
  name: openshift-pipelines-operator-rh
{{- end }}
{{- if .Values.tekton.operator }}{{- if .Values.tekton.operator.source }}{{- if .Values.tekton.operator.source.name }}
  source: {{ .Values.tekton.operator.source.name | quote }}
{{- else }}
  source: redhat-operators
{{- end }}
{{- else }}
  source: redhat-operators
{{- end }}
{{- else }}
  source: redhat-operators
{{- end }}
{{- if .Values.tekton.operator }}{{- if .Values.tekton.operator.source }}{{- if .Values.tekton.operator.source.namespace }}
  sourceNamespace: {{ .Values.tekton.operator.source.namespace | quote }}
{{- else }}
  sourceNamespace: openshift-marketplace
{{- end }}
{{- else }}
  sourceNamespace: openshift-marketplace
{{- end }}
{{- else }}
  sourceNamespace: openshift-marketplace
{{- end }}
{{- if .Values.tekton.version }}{{- if .Values.tekton.operator }}{{- if .Values.tekton.operator.csv }}
  startingCSV: "{{ .Values.tekton.operator.csv }}.v{{ .Values.tekton.version }}"
{{- else }}
  startingCSV: "openshift-pipelines-operator.v{{ .Values.tekton.version }}"
{{- end }}
{{- else }}
  startingCSV: "openshift-pipelines-operator.v{{ .Values.tekton.version }}"
{{- end }}
{{- else }}
  startingCSV: "openshift-pipelines-operator.v1.0.1"
{{- end }}
{{- end }}{{- end }}